---
title: "final_data_analysis_4-30"
author: "Oivia Borgula"
date: 04/30/2024
format: html
editor: visual
---
**INTRODUCTION** This data analysis project will examine how incarceration, wealth and race intersect and play a role in voter registration in Baltimore City â€” an especially newsworthy topic ahead of elections season this November. Specifically, I will ask these five questions to guide my findings:

1. Which community in Baltimore had the least amount of registered voters in August 2020? Which had the most? 

2. What was the rate of incarceration in the top 10 areas with the lowest voter turnout? What about in the top 10 areas with the highest voter turnout?

3. How many people registered to vote in the August 2020 in the top 10 areas in Baltimore City with the highest median household income? What about in the 10 lowest areas? 

4. Which race in Baltimore had the least amount of registered voters in August 2020 as a share of their voting precinct population numbers? 

5. How has voter registration data changed in the past four years?

**THE DATA**
The core datasets I will use (not including new datasets I create through joins) include: 

1. demo_voting_x2020_politics - voter demographic information by voting precinct in 2020 in Baltimore City via the Maryland Department of Planning. Contains the number of people in each precinct by race.  https://planning.maryland.gov/Redistricting/Documents/2020data/GreenReport.pdf

2. incarceration_x2020 - a data table scraped from a Prison Policy Initiative website with information about the incarceration rate in different Baltimore zip codes in 2020. https://www.prisonpolicy.org/origin/md/2020/zipcode.html

3. x2020_precinct_voters - voter registration counts in 2020 by voting precinct in Baltimore City via the city's voting information page. https://boe.baltimorecity.gov/registration-figures

4. precinct_addresses_x2020 - table with information about precinct numbers, zip codes and addresses. I imputting this website from 2024 into the wayback machine to get 2020 datasets. https://boe.baltimorecity.gov/boe-polling-locations 

5. zip_csa - table with Baltimore City's community statistical areas, or CSAs and zip codes. https://bniajfi.org/mapping-resources/

6. baltcity_income - data given in labs about median household income in Baltimore City CSAs from different years, including 2020. 

7. x20204_precinct_voters - voter registration counts in 2024 by voting precinct in Baltimore City via the city's voting information page.
https://boe.baltimorecity.gov/registration-figures

I use all these datasets in some form for nearly every question. 

**SET UP**
```{r}
#libraries and settings
library(tidyverse)
library(janitor)
library(formattable)
library(dplyr)
library(rvest)

#turn off scientific notation
options(scipen=999)
```

**UPLOAD/CLEAN DATA**

demo_voting_x2020_politics
```{r}
#voting by demographic 2020
demo_voting_x2020_politics <- read_csv("data/demo_voting_x2020_finalll.csv", locale=locale(encoding="latin1"))%>%
  clean_names
#delete top seven rows for worcester copied from the page before and column three filled with only N/As
demo_voting_x2020_politics <- demo_voting_x2020_politics[-c(1:7), -3]%>%
  slice(-1)%>%
  rename(precinct = voting_district_vtd)

nopolitics_demo_voting_x2020 <- demo_voting_x2020_politics %>%
  select(precinct, total_population)
```

x2020_precinct_voters
I don't need political party data for any of my questions, so I'll get rid of it for this project
```{r}
#voting data by voting precinct in baltimore city in August 2020 
x2020_precinct_voters <- read_csv("data/cleaned_precinct_x2020.csv")
#remove blank rows
x2020_precinct_voters <- x2020_precinct_voters[complete.cases(x2020_precinct_voters), ]

x2020_precinct_voters <- x2020_precinct_voters[-111, ]%>%
  rename(total_reg = total)%>%
  select(precinct, total_reg)
```

precinct_addresses
```{r}
#table with information about precinct numbers, zip codes and addresses
precinct_addresses_x2020 <- read_csv("data/zip_precinct_x2020_cleaned.csv")%>%
  clean_names()
precinct_addresses_x2020 <- precinct_addresses_x2020%>%
  rename(precinct = ward_and_precincts)
```

incarceration_x2020
```{r}
#webscrape data table from prison policy initiative website 
incarceration_x2020 <- "https://www.prisonpolicy.org/origin/md/2020/zipcode.html"
incarceration_x2020 <- incarceration_x2020 %>% 
  read_html() %>% 
  html_table()

incarceration_x2020 <- incarceration_x2020[[1]]%>%
  clean_names()%>%
  rename(zip = 1, city = 2, num_prison = 3, census_pop = 4, total_pop = 5, rate_per_x100000 = 6)

#filter so the city is only Baltimore
incarceration_x2020 <- incarceration_x2020 %>%
  filter(city == "Baltimore")
```

Join above four datasets 
```{r}
#join nopolitics_demo_voting_x2020 with x2020_precinct_voters by precinct
demo_precinct <- inner_join(nopolitics_demo_voting_x2020, x2020_precinct_voters, by = "precinct")

#add column for percent of whole 
demo_precinct <- demo_precinct%>%
  mutate(pct_reg = percent(total_reg / total_population))

#join this with zip code data by precinct
zip_demo_precinct <- inner_join(demo_precinct, precinct_addresses_x2020, by = "precinct")%>%
  select(zip, precinct, total_population, total_reg, pct_reg)

#join this with incarceration data by zip code
reg_incarceration <- inner_join(zip_demo_precinct, incarceration_x2020, by = "zip") 
```

Aggregate each zip code
sum(total_population) / sum(total_reg)

**Q1: Which 10 communities in Baltimore had the least amount of registered voters in August 2020? Which 10 had the most?**
```{r}
reg_bottom_10 <- zip_demo_precinct%>%
  slice_min(pct_reg, n = 10)

reg_top_10 <- zip_demo_precinct%>%
  slice_max(pct_reg, n = 10)
```

group by zip codes and average voting registration and 
open baltimore crosswalk zip code 
write at highly aggregated level of zip codes 
