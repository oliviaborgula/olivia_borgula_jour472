---
title: "Olivia Borgula Data Analysis Project"
date: 4/25/24
format: html
editor: visual
---

**NOTE** I plan to add one more data set, which contains a list of precincts and their corresponding census tracts and neighborhoods in Baltimore from the city's website. I still need to upload through Tabula and clean it.

**INTRODUCTION** This data analysis project will examine how incarceration, wealth and race intersect and play a role in voter registration in Baltimore City â€” an especially newsworthy topic ahead of elections season this November. Specifically, I will ask these five questions to guide my findings:

1.  How many people were incarcerated in the top 10 areas with the lowest voter turnout? What about in the top 10 areas with the highest voter turnout?

2.  How many people registered to vote in August 2020 in the top 10 neighborhoods in Baltimore City with the highest median household income? What about in the five lowest areas?

3.  How many people were incarcerated in the top 10 areas with the highest median household income

4.  What race in Baltimore City had the lowest number of registered voters in the 2020 election? Which had the lowest?

5.  dem/republican

**THE DATA** The core data sets include: 1. demo_voting_x2020 - voter demographic information by voting precinct in 2020 in Baltimore City via the Maryland Department of Planning. Contains the number of people in each precinct by race. I'll use this data for question 4. https://planning.maryland.gov/Redistricting/Documents/2020data/GreenReport.pdf

2.  baltcity_income - given to use in past labs. Contains information about the median household income in Baltimore in various years, including 2020. I'll use this dataset for question 3.

3.  balt_incarceration - a data table scraped from a Prison Policy Initiative website with information about the incarceration rate in different Baltimore neighborhoods in 2020. I'll use this data for questions 1, 2 and 5. https://www.prisonpolicy.org/origin/md/2020/baltimore_csa.html

4.  x2024_precinct_voters - voter registration counts in 2024 by voting precinct in Baltimore City via the city's voting information page. I'll use this dataset for the last question. https://boe.baltimorecity.gov/registration-figures

5.  x2020_precinct_voters - voter registration counts in 2020 by voting precinct in Baltimore City via the city's voting information page. I'll use this for every questsion. https://boe.baltimorecity.gov/registration-figures

**SET UP**

```{r}
#libraries and settings
library(tidyverse)
library(janitor)
library(formattable)
library(dplyr)
library(rvest)
library(tidyverse)
library(tidycensus)

#turn off scientific notation
options(scipen=999)
```

```{r}
#upload census key
census_api_key("dfcb820a29176622bc44d5c66b77d03b5675937d", install=TRUE, overwrite = TRUE)
```

To start, I need to upload data for voting by precinct in 2020 and 2024, Baltimore City income and voting by demographic in 2020. The incarceration data will come later.

```{r}
#upload CSVs and start cleaning data 

#voting data by voting precinct in baltimore city in 2024 
x2024_precinct_voters <- read_csv("data/tabula-2024-precinct-voter-counts.csv")
#remove blank rows
x2024_precinct_voters <- x2024_precinct_voters[complete.cases(x2024_precinct_voters), ]

#voting data by voting precinct in baltimore city in August 2020 
x2020_precinct_voters <- read_csv("drfata/cleaned_precinct_x2020.csv")
#remove blank rows
x2020_precinct_voters <- x2020_precinct_voters[complete.cases(x2020_precinct_voters), ]
  
#income in baltimore city
baltcity_income <- read_csv("data/baltcity_income.csv")%>%
  clean_names()

#voting by demographic
demo_voting_x2020 <- read_csv("data/demo_voting_x2020.csv", locale=locale(encoding="latin1"))%>%
  clean_names
#delete top seven rows for worcester copied from the page before and column three filled with only N/As
demo_voting_x2020 <- demo_voting_x2020[-c(1:7), -3]

#income by baltimore city census tracts + clean data
income_tract <- read_csv("data/income_tract.csv")%>%
  clean_names()
#convert geoid to character and get rid of the stuff that isn't the actual geoid
income_tract$geo_id <- as.character(income_tract$geo_id)
income_tract$geo_id <- substr(income_tract$geo_id, 10, 20)
#get rid of the unnecesary second row
income_tract <- income_tract[-1, ]
#rename columns that are important
income_tract <- income_tract %>% 
  rename(median_income = 25)
#make new, cleaner table with important stuff
income_tract_clean <- income_tract%>%
  select(geo_id, median_income)
```

**Q1: In the top 10 areas with the highest incarceration rates, how many people registered to vote in the 2020 election? What about in the 10 areas with the lowest incarceration rate?**

Part 1: in the top 10 areas with the highest incarceration rates, how many people registered to vote in the 2020 election?

```{r}
#webscrape data table from prison policy initiative website 
balt_incarceration <- "https://www.prisonpolicy.org/origin/md/2020/baltimore_csa.html"
balt_incarceration <- balt_incarceration %>% 
  read_html() %>% 
  html_table()

balt_incarceration <- balt_incarceration[[1]]%>%
  clean_names()%>%
  rename(neighborhood = 1, num_prison = 2, x2020_census_pop = 3, x2020_total_pop = 4, rate_per_x100000 = 5)

balt_incarceration <- balt_incarceration %>%
  mutate(rate_per_x100000 = as.numeric(gsub(",", "", rate_per_x100000)))%>%
    arrange(desc(rate_per_x100000))

#top ten table
top_balt_incarcerated <- balt_incarceration %>%
  select(neighborhood, rate_per_x100000)%>%
  slice_max(rate_per_x100000, n = 10)
```

Part 2: what about the top ten areas with the lowest?

```{r}
#bottom ten table of incarceration rates
bottom_balt_incarcerated <- balt_incarceration %>%
  select(neighborhood, rate_per_x100000)%>%
  slice_min(rate_per_x100000, n = 10)
```

**Q2: In each of the top 10 areas with the lowest voter turnout, how many people were incarcerated? How does that compare to areas of high voter turnout?**

```{r}
#rename columns for joining (in seperate code chunck because after running for the first time can't run again)
demo_voting_x2020 <- demo_voting_x2020 %>% 
  rename(precinct = voting_district_vtd)
```

```{r}
#join precinct voter registration with precinct population numbers
voting_reg_pop <- demo_voting_x2020 %>%
  inner_join(x2020_precinct_voters, by="precinct")

#rename column for clarity and add column to show voter registration as proportion of population
voting_reg_pop <- voting_reg_pop %>% 
  rename(num_registered = total)%>%
  mutate(pct_registered = percent(num_registered / total_population))%>%
  arrange(pct_registered)

bottom_10_reg <- voting_reg_pop%>%
  select(precinct, total_population, num_registered, pct_registered)%>%
  slice_min(pct_registered, n = 10)

```

**Q3: How many people registered to vote in August 2020 in the top five areas in Baltimore City with the highest median household income? What about in the five lowest areas?**

```{r}


```

**Q4: What race in Baltimore City had the lowest number of registered voters as a proportion of their population in August 2020? Which had the highest?**

```{r}
#clean voting_reg_pop table so it just has the info we need for this question

```

```{r}
#CUTS
#join baltcity_income and balt_incarceration
incarceration_wealth <- baltcity_income %>%
  inner_join(balt_incarceration, by="neighborhood")

incarceration_wealth

balt_incarceration_bleh <- balt_incarceration%>%
  select(neighborhood)

#income by baltimore city census tracts + clean data
income_tract <- read_csv("data/income_tract.csv")%>%
  clean_names()
#convert geoid to character and get rid of the stuff that isn't the actual geoid
income_tract$geo_id <- as.character(income_tract$geo_id)
income_tract$geo_id <- substr(income_tract$geo_id, 10, 20)
#get rid of the unnecesary second row
income_tract <- income_tract[-1, ]
#rename columns that are important
income_tract <- income_tract %>% 
  rename(median_income = 25)
#make new, cleaner table with important stuff
income_tract_clean <- income_tract%>%
  select(geo_id, median_income)
```
